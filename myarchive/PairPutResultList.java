package myarchive;

import wsiarchive.*;
import java.util.Random;

// nichtleere Liste von PutResults
public class PairPutResultList implements IPutResultList {
    private IPutResult first;
    private IPutResultList rest;
    
    public PairPutResultList(IPutResult first, IPutResultList rest) {
        this.first = first;
        this.rest = rest;
    }
    
    // erstes Element extrahieren
    public IPutResult getFirst() {
        return this.first;
    }
    
    // Rest extrahieren
    public IPutResultList getRest() {
        return this.rest;
    }
    
    // in IPutResultList aus wsiarchive umwandeln
    public wsiarchive.IPutResultList toWSIPutResultList() {
        return new wsiarchive.PairPutResultList(this.first,
                                                this.rest.toWSIPutResultList());
    }
    
        
    // ist eine id in der resultlist.
    public boolean isItemIdIn(IItemId id) {
        // hat das erste resultat oder der rest die itemID
        return ((((OKPutResult) this.first).getId() == id) || this.rest.isItemIdIn(id));
    }
    
        
    // schreibt ein putresult in die liste, wenn sie noch nicht drinnen ist
    public void addPutResult(IPutResult putresult) {
        // ist das item noch nicht vorhanden füge es zur liste hinzu
        if (!this.isItemIdIn(((OKPutResult) putresult).getId())) {
            this.rest = new PairPutResultList(
              putresult,
              this.rest
            );
        }
        // sonst tue halt nichts
        else {
            return;
        }
    }
    
        
    // Zählt die Anzahl an OKPutResulsts in der Liste
    public int countOKPutResult() {
        if (this.first instanceof OKPutResult) {
            return 1 + this.rest.countOKPutResult();
        }
        else {
            return this.rest.countOKPutResult();
        }
    }
    
    // Schmeißt alle fullputresulsts zurück
    public IPutResultList cleanFull() {
        if (this.first instanceof FullPutResult) {
            return this.rest.cleanFull();
        }
        else {
            return new PairPutResultList(
                this.first,
                this.rest.cleanFull()
            );
        }
    }
    
        
    // liefert ein zufälliges PutResult zurück.
    public IPutResult getRandom() {
        // wir gehen davon aus das die liste jetzt nur OKPutResult enthält, weil wir vorher cleanFull aufrufen
        int length = this.countOKPutResult();
        int r = new Random().nextInt(length);
        return this.getN(r);
    }
    
    //liefert das n-te Item einer Liste
    public IPutResult getN(int n) {
        if (n == 0) {
            return this.first;
        }
        else {
            return this.rest.getN(n - 1);
        }
    }
    

}
