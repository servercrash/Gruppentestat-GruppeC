package myarchive;

import wsiarchive.*;
import org.junit.*;

public class limitedArchiveTest extends de.tuebingen.informatik.Test {

    Item item1 = new Item("cck", 120); // Inhalt mit cck 120MB
    Item item2 = new Item("views", 50); // Inhalt mit Views 50MB
    Item item3 = new Item("panels", 60); // Inhalt mit Panels 60MB
    WORM w1 = new WORM("contrib"); // Neuer Worm
    WORMItemId wii = new WORMItemId(); // itemid für testfälle
    
    @Test
    public void testGetName() {
        limitedArchive la1 = new limitedArchive("bioinformatiker", w1, 100);
        // testet die methode getName();
        checkExpect(la1.getName(), "bioinformatiker");
    }
    
    @Test
    public void testPut() {
        limitedArchive la1 = new limitedArchive("bioinformatiker", w1, 100); // Archive mit 100MB
        limitedArchive la2 = new limitedArchive("bioinformatiker", w1, 100); // neue Kopie von la1
        // größeres Item als maximales Speicher -> geht nicht rein
        checkExpect(la1.put(item1), new wsiarchive.FullPutResult());
        // item was genug klein ist zum speichern
        checkExpect(la1.put(item2), new wsiarchive.OKPutResult(wii));
        // zusammen 100MB // genau voll
        checkExpect(la1.put(item2), new wsiarchive.OKPutResult(wii));
        
        // diesmal fügen wir erst views und dann panels hinzu -> panels ist zu groß
        checkExpect(la2.put(item2), new wsiarchive.OKPutResult(wii));
        checkExpect(la2.put(item3), new wsiarchive.FullPutResult());
    }
    
    // Test get Methoden.
    @Test
    public void testGet() {
        limitedArchive la1 = new limitedArchive("bioinformatiker", w1, 100); // Archive mit 100MB
        IPutResult r = la1.put(item2);
        // PutResult ist ok.
        OKPutResult r1 = (OKPutResult) r;
        
        // Nun können wir aus r1 die ITEMID auslesen und schauen ob get item2 zurückliefert
        IGetResult g = la1.get(r1.getId());
        // wir wissen es ist ein richtiges resultat
        ItemResult g1 = (ItemResult) g;
        checkExpect(g1.getItem(), item2);
    }
}
